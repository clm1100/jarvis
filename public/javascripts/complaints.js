function create(){window.location.href="/complaints/new"}function edit(a){window.open("/complaints/"+a,"_blank")}function destroy(a){$.ajax({url:"/complaints/"+a,type:"DELETE",success:function(a){$(".alert strong").html(a.message),$(".alert").show().fadeIn(),datatables?datatables.draw():history.go(-1)}})}function showUserSelectModal(){var a=$("#user-select-modal");a.find("input[name=nickname]").val(""),a.find("p.user").remove(),a.modal("show")}function searchUsers(){var a=doT.template($("#users-tpl").text()),b=$("#user-select-modal"),c=b.find("input[name=nickname]").val(),d="/api/users/search/"+c+"/0";$.get(d,function(c){var d=a(c);b.find(".modal-body").append(d)})}function selectUser(a,b){var c=$("#user-select-modal");$("form input[name=user]").val(a),$("form input[name=user-nickname]").val(b),c.modal("hide")}function showCommoditySelectModal(){var a=$("#commodity-select-modal");a.find("input[name=t]").val(""),a.find("p.commodity").remove(),a.modal("show")}function searchCommodities(){var a=doT.template($("#commodities-tpl").text()),b=$("#commodity-select-modal"),c=b.find("input[name=t]").val(),d="/api/commodities/search/"+c+"/0";$.get(d,function(c){var d=a(c);b.find(".modal-body").append(d)})}function selectCommodity(a,b){var c=$("#commodity-select-modal");$("form input[name=commodity]").val(a),$("form input[name=commodity-t]").val(b),c.modal("hide")}var datatables;$(document).ready(function(){var a=$("#main-datatables");a&&(datatables=a.DataTable({language:{url:"/javascripts/libs/datatables-chinese.json"},processing:!0,serverSide:!0,order:[[3,"desc"]],ajax:"/api/complaints",columns:[{name:"id"},{name:"nickname"},{name:"commodity"},{name:"reason"},{name:"at"},{name:"processed"}],columnDefs:[{targets:[4],render:function(a,b,c){return moment(a).fromNow()}},{targets:[6],render:function(a,b,c){return"<button onclick=\"edit('"+c[0]+'\')" class="btn btn-info">编辑</button>&nbsp;<button onclick="destroy(\''+c[0]+'\')" class="btn btn-danger">删除</button>'}}]}))});