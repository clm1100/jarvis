function create(){window.location.href="/lotteries/new"}function edit(a){window.open("/lotteries/"+a,"_blank")}function destroy(a){$.ajax({url:"/lotteries/"+a,type:"DELETE",success:function(a){$(".alert strong").html(a.message),$(".alert").show().fadeIn(),datatables?datatables.draw():history.go(-1)}})}function editPrize(a,b,c,d,e){var f=url(-1,window.location.href);$("#prize-edit-modal").modal("show");var g=$("#prize-edit-form");g.find("input[name=id]").val(f),g.find("input[name=pid]").val(a),g.find("input[name=title]").val(c),g.find("select[name=order]").val(b),g.find("input[name=num]").val(d),g.find("select[name=type]").val(e)}function savePrize(){$("#prize-edit-modal").modal("hide");var a=$("#prize-edit-form").serializeObject();return $.post("/api/prizes",a,function(a){}),!1}function addPrize(){$("#prize-add-modal").modal("show")}function ajaxadd(a){var b="/prize/new",c=$("#prize-add-form"),d={id:a,title:c.find("input[name=title]").val(),order:c.find("select[name=order]").val(),num:c.find("input[name=num]").val(),type:c.find("select[name=type]").val()};$.post(b,d,function(a){}),location.reload()}function destroyPrize(a,b){var c="/prize/del",d={pid:a,id:b};BootstrapDialog.show({title:"此操作不可恢复!",message:"确认要删除这个攻略吗?",buttons:[{label:"取消",action:function(a){a.close()}},{label:"删除",action:function(a){$.ajax({url:c,type:"POST",data:d,success:function(){a.close(),location.reload()}})}}]})}function editorPrize(){$("#prize-edit-form").submit(),location.reload()}var datatables;$(document).ready(function(){var a=$("#main-datatables");a&&(datatables=a.DataTable({language:{url:"/javascripts/libs/datatables-chinese.json"},processing:!0,serverSide:!0,order:[[3,"desc"]],ajax:"/api/lotteries",columns:[{name:"id"},{name:"t"},{name:"num"},{name:"start"},{name:"end"},{name:"close"}],columnDefs:[{targets:[3],render:function(a,b,c){return moment(a).fromNow()}},{targets:[4],render:function(a,b,c){return moment(a).fromNow()}},{targets:[5],render:function(a,b,c){return moment(a).fromNow()}},{targets:[6],render:function(a,b,c){return"<button onclick=\"edit('"+c[0]+"')\" class='btn btn-info'>编辑</button>&nbsp;<button onclick=\"destroy('"+c[0]+"')\" class='btn btn-danger hide'>删除</button>"}}]}));var b=$("#prize-edit-form");b&&b.length>0&&b.submit(function(){return savePrize(),!1})}),$(function(){$("#example_lottery").dataTable()});